function [copperLoss,strandNumber,strandWidth,strandHeight] = roebelAnalysis(axialLength,slotNumber,slotWidth,slotHeight)
% Unit Conversion of Inputs (mm to m)
axialLength = axialLength*1e-3;
slotWidth = slotWidth*1e-3;
slotHeight = slotHeight*1e-3;

% Parameters
Iph=1860;% in A % phase current rms
wedgeHeight = 5.5e-3; % in m
slotSpacerHeight = 5.5e-3; % in m % spacer between top and bottom coils
mainInsulationThickness = 3e-3; % in m
slotSpringThickness = 1e-3; % in m
slotFillingTolerance = 0.2e-3; % in m % not cutting tolerance, used for coil production

length=2*axialLength*slotNumber;     % in m % Total copper length in active region
total_height=(slotHeight - wedgeHeight - slotSpacerHeight - slotSpringThickness)...
              /2 - 2*mainInsulationThickness; % in m % slot copper height for single coil without main isolation

strandInsulation=0.22e-3;   % in m % strand-to-strand insulation length
total_width=slotWidth - 2*slotFillingTolerance;    % in m % total copper width with isolation

numberOfhorizontalStrand=2; % number of  horizontal strands 
width_strand=(total_width - 2*mainInsulationThickness)/2 - strandInsulation; % in m % strand width 

ro=2.0968e-8;         % in Ohm*m  % resistivity at 125 degree
k=2.2;                % unitless % (endwinding+active)/active region ratio % empirical 
mu0=4*pi*1e-7;        % permeability
f=50;                 % in 1/s % frequency of the current

% Arrays
height_strand_X=[];  % in m  % array recording different strand heights 
                     % according to number of vertical...
                     % strands and slot copper height for single copper
Pdc_tot=[];          % in kW % Total DC loss consisting both top and 
                     % bottom windings
P_eddy_tot=[];       % in kW % Total Eddy loss consisting both top and
                     % bottom windings.  Not include circulation current 
                     % which is eliminated by roebel transposition
strand=[];           % array recording the number of vertical strands 
                     % numberOfverticalStrand
TopBottom=[];        % Eddy losses ratio of top to bottom coils

% Main Loop
i = 1;
for numberOfverticalStrand=10:1:50 % indexing number of vertical strands  
Bmax=(2*mu0*Iph)/(total_width); % Maximum tangential B, generated by coils
                                % We have two coils, called top and bottom
                                % Top coil is the coil close to airgap
                                % Bottom coil is the coil far away from 
                                % to airgap
                                
B=linspace(0,Bmax,numberOfverticalStrand*2); % B for each strand 
                             % First half of the array belongs to top   
                             % Latter half of the array belongs to bottom 


Ke= pi^2/(6*ro);                % The constant for eddy losses

height_strand=(total_height/numberOfverticalStrand)-strandInsulation; %corrected with below one
                                % the height for strand according to 
                                % strand number

DC_resistance=ro*length*k/((width_strand*height_strand)); 
                                % DC resistance for unit area included both
                                % active and endwinding region
                                % for both top and bottom coil
DC_resistance=DC_resistance/(numberOfverticalStrand*numberOfhorizontalStrand);
                                % DC resistance for unit area included both
                                % active and endwinding region
                                % for both top and bottom coil
                                                              
Pdc=Iph^2*DC_resistance;        % DC losses for the indexed strand


volume=numberOfhorizontalStrand*width_strand*height_strand*length; 
                                % strand volume for each vertical level
                                % included 2 horizontal strand

Peddy= Ke*B.^2*f^2*height_strand^2*volume;
                                % Eddy losses for each vertical level

Pdc_tot=[Pdc_tot Pdc];               % Total DC losses for the
                                     % indexed strand number

P_eddy_tot=[P_eddy_tot sum(Peddy)];  % Total Eddy losses for the
                                     % indexed strand number
                                     
TopBottom=[TopBottom ...
    sum(Peddy(1:numberOfverticalStrand/2))/...
    sum(Peddy(numberOfverticalStrand/2+1:end))];
                                     % Eddy losses ratio of top 
                                     % to bottom coils
                
strand=[strand numberOfverticalStrand]; 
                       % array recording the number of vertical strands 
                       % numberOfverticalStrand
height_strand_X=[height_strand_X height_strand];
                     % in m  % array recording different strand heights 
                     % according to number of vertical...
                     % strands and slot copper height for single copper

 if i>1 && (P_eddy_tot(i)+Pdc_tot(i)-P_eddy_tot(i-1)-Pdc_tot(i-1))/Pdc_tot(1) < 0.01
     index = i;
     break
 end
 i = i +1;
end

totalCopperLoss = Pdc_tot + P_eddy_tot;
%[minimumLoss, index] = min(totalCopperLoss);
minimumLoss = totalCopperLoss(index);

copperLoss = minimumLoss
strandNumber = strand(index)*2
strandWidth = width_strand % in ANSYS, mm is already defined
strandHeight = height_strand_X(index)
end